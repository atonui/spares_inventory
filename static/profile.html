<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile Management</title>
    <link rel="stylesheet" href="mystyle.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/alpinejs/3.13.0/cdn.js" defer></script>
    <script src="script.js"></script>
</head>
<body>
    <div x-data="profileManager()" x-init="init()">
        <div class="container">
            <!-- Header -->
            <div class="header">
                <div class="user-info">
                    <div>
                        <h2>Profile Management</h2>
                        <p>Manage your account settings</p>
                    </div>
                    
                </div>
                <div class="back-link">
                        <a href="=/static/index.html">‚Üê Back to Dashboard</a>
                    </div>
            </div>

            <!-- Loading State -->
            <div x-show="loading" class="loading">Loading profile...</div>

            <!-- Error/Success Messages -->
            <div x-show="error" class="error" x-text="error"></div>
            <div x-show="successMessage" class="success" x-text="successMessage"></div>

            <!-- Profile Card -->
            <div x-show="!loading" class="inventory-table" style="margin-bottom: 1.5rem;">
                <div style="padding: 1rem; background: #f8f9fa; border-bottom: 1px solid #ddd;">
                    <div style="display: flex; gap: 0.5rem; border-bottom: 2px solid #e5e7eb;">
                        <button 
                            @click="activeTab = 'profile'" 
                            :style="activeTab === 'profile' ? 'border-bottom: 2px solid #007bff; margin-bottom: -2px;' : ''"
                            style="padding: 0.5rem 1rem; background: none; border: none; cursor: pointer; font-weight: 500;">
                            Profile Info
                        </button>
                        <button 
                            @click="activeTab = 'password'" 
                            :style="activeTab === 'password' ? 'border-bottom: 2px solid #007bff; margin-bottom: -2px;' : ''"
                            style="padding: 0.5rem 1rem; background: none; border: none; cursor: pointer; font-weight: 500;">
                            Change Password
                        </button>
                    </div>
                </div>

                <!-- Profile Info Tab -->
                <div x-show="activeTab === 'profile'" style="padding: 2rem;">
                    <form @submit.prevent="updateProfile()">
                        <div class="form-group">
                            <label>Name</label>
                            <input type="text" x-model="profile.name" disabled style="background: #f8f9fa; cursor: not-allowed;">
                            <small style="color: #666; display: block; margin-top: 0.25rem;">
                                Contact your administrator to change your name
                            </small>
                        </div>

                        <div class="form-group">
                            <label>Email Address</label>
                            <input 
                                type="email" 
                                x-model="profile.email"
                                disabled style="background: #f8f9fa; cursor: not-allowed;">
                            <small style="color: #666; display: block; margin-top: 0.25rem;">
                                Contact your administrator to change your email
                            </small>
                        </div>

                        <div class="form-group">
                            <label>Role</label>
                            <input type="text" x-model="profile.role" disabled style="background: #f8f9fa; cursor: not-allowed;">
                        </div>

                        <div class="form-group" x-show="profile.territory">
                            <label>Territory</label>
                            <input type="text" x-model="profile.territory" disabled style="background: #f8f9fa; cursor: not-allowed;">
                        </div>

                        <!-- <button type="submit" class="btn btn-success" :disabled="saving">
                            <span x-show="!saving">Update Profile</span>
                            <span x-show="saving">Updating...</span>
                        </button> -->
                    </form>
                </div>

                <!-- Change Password Tab -->
                <div x-show="activeTab === 'password'" style="padding: 2rem;">
                    <form @submit.prevent="changePassword()">
                        <div class="form-group">
                            <label>Current Password</label>
                            <input 
                                type="password" 
                                x-model="passwordForm.current_password"
                                required
                            >
                        </div>

                        <div class="form-group">
                            <label>New Password</label>
                            <input 
                                type="password" 
                                x-model="passwordForm.new_password"
                                @input="checkPasswordStrength()"
                                required
                                minlength="8"
                            >
                            <div class="password-strength" x-show="passwordForm.new_password">
                                <div class="password-strength-bar" :class="passwordStrength"></div>
                            </div>
                            <small style="color: #666; display: block; margin-top: 0.5rem;">
                                Password must be at least 8 characters long
                            </small>
                        </div>

                        <div class="form-group">
                            <label>Confirm New Password</label>
                            <input 
                                type="password" 
                                x-model="passwordForm.confirm_password"
                                required
                                minlength="8"
                            >
                        </div>

                        <button type="submit" class="btn btn-success" :disabled="saving">
                            <span x-show="!saving">Change Password</span>
                            <span x-show="saving">Changing...</span>
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>
    </body>
</html>