<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reset Password</title>
    <link rel="stylesheet" href="mystyle.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/alpinejs/3.13.0/cdn.js" defer></script>
    <script src="script.js"></script>
    </head>
<body>
    <div class="card" x-data="resetPassword()" x-init="init()">
        <div class="card-header">
            <h1>Reset Password</h1>
            <p x-show="!success">Create a new password for your account</p>
        </div>
        <div class="card-body">
            <!-- Loading State -->
            <div x-show="validating" class="loading-spinner">
                <div class="spinner"></div>
                <p style="margin-top: 16px; color: #6b7280;">Verifying reset link...</p>
            </div>

            <!-- Invalid Token -->
            <div x-show="!validating && !tokenValid && !success">
                <div class="alert alert-error">
                    <span x-text="message.text || 'Invalid or expired reset link'"></span>
                </div>
                <div class="back-link">
                    <a href="/forgot-password">Request a new reset link →</a>
                </div>
            </div>

            <!-- Alert Messages -->
            <div x-show="tokenValid && message.text && !success" class="alert" 
                 :class="message.type === 'success' ? 'alert-success' : 'alert-error'">
                <span x-text="message.text"></span>
            </div>

            <!-- Reset Form -->
            <div x-show="!validating && tokenValid && !success">
                <form @submit.prevent="submitReset">
                    <div class="form-group">
                        <label for="new_password">New Password</label>
                        <input 
                            type="password" 
                            id="new_password" 
                            x-model="newPassword"
                            @input="checkPasswordStrength"
                            required
                            minlength="8"
                            autofocus
                        >
                        <div class="password-strength" x-show="newPassword">
                            <div class="password-strength-bar" :class="passwordStrength"></div>
                        </div>
                        <div class="password-requirements">
                            <ul>
                                <li>At least 8 characters long</li>
                                <li>Mix of uppercase and lowercase letters</li>
                                <li>Include at least one number</li>
                                <li>Include at least one special character</li>
                            </ul>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="confirm_password">Confirm New Password</label>
                        <input 
                            type="password" 
                            id="confirm_password" 
                            x-model="confirmPassword"
                            required
                            minlength="8"
                        >
                    </div>

                    <button type="submit" class="btn btn-primary" :disabled="loading">
                        <span x-text="loading ? 'Resetting...' : 'Reset Password'"></span>
                    </button>
                </form>
            </div>

            <!-- Success State -->
            <div x-show="success">
                <div class="success-icon">✓</div>
                <div class="alert alert-success">
                    Password reset successfully!
                </div>
                <p style="text-align: center; color: #374151; margin-bottom: 20px;">
                    You can now login with your new password.
                </p>
                <a href="/static/index.html" class="btn btn-primary" style="display: block; text-decoration: none; text-align: center;">
                    Go to Login
                </a>
            </div>

            <div class="back-link" x-show="!success">
                <a href="/static/index.html">← Back to Login</a>
            </div>
        </div>
    </div>
</body>
</html>